<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Convertisseur normes RAN</title>

<style>
:root {
    --primary:#2c3e50;
    --accent:#3498db;
    --success:#27ae60;
    --warning:#f39c12;
    --bg:#f4f7f6;
}

body {
    font-family: "Segoe UI", sans-serif;
    background: var(--bg);
    margin: 0;
    padding: 40px 20px;
    display: flex;
    justify-content: center;
}

.app {
    background: #fff;
    max-width: 1050px;
    width: 100%;
    padding: 40px;
    border-radius: 12px;
    box-shadow: 0 10px 25px rgba(0,0,0,0.06);
    position: relative;
}

/* README popover */
.help {
    position: absolute;
    top: 20px;
    right: 20px;
    width: 30px;
    height: 30px;
    background: var(--accent);
    color: #fff;
    border-radius: 50%;
    text-align: center;
    line-height: 30px;
    font-weight: bold;
    cursor: pointer;
}

.popover {
    display: none;
    position: absolute;
    top: 60px;
    right: 20px;
    width: 360px;
    background: #fff;
    border: 1px solid #ddd;
    box-shadow: 0 8px 24px rgba(0,0,0,0.15);
    padding: 20px;
    border-radius: 8px;
    font-size: 0.95rem;
    line-height: 1.5;
    z-index: 100;
}

.help:hover + .popover,
.popover:hover {
    display: block;
}

h1 {
    margin-top: 0;
    border-left: 5px solid var(--accent);
    padding-left: 15px;
}

.editor {
    min-height: 360px;
    border: 2px solid #e1e5e8;
    border-radius: 8px;
    padding: 20px;
    outline: none;
    font-size: 15px;
}

.editor:focus {
    border-color: var(--accent);
}

.notice {
    margin-top: 15px;
    background: #fff3cd;
    padding: 12px;
    border-left: 4px solid var(--warning);
    font-size: 0.9rem;
}

.controls {
    margin-top: 22px;
    display: flex;
    gap: 12px;
    flex-wrap: wrap;
}

button {
    padding: 12px 22px;
    border: none;
    border-radius: 6px;
    font-weight: 600;
    cursor: pointer;
}

.btn-main { background: var(--accent); color: #fff; }
.btn-copy { background: var(--success); color: #fff; }
.btn-reset { background: #ecf0f1; }

.footer {
    margin-top: 35px;
    padding-top: 20px;
    border-top: 1px solid #eee;
    display: flex;
    gap: 15px;
    flex-wrap: wrap;
}

.tag {
    text-decoration: none;
    font-size: 0.85rem;
    color: var(--accent);
    background: #ebf5fb;
    padding: 7px 16px;
    border-radius: 20px;
    font-weight: 500;
}
.tag:hover { background: #d6eaf8; }
</style>
</head>

<body>

<div class="app">

<div class="help">i</div>
<div class="popover">
<strong> README ‚Äî Normes RAN</strong><br><br>

Cet outil permet d‚Äôadapter des r√©f√©rences bibliographiques d√©j√†
normalis√©es selon les usages <em>Mosa√Øques arch√©ologie</em>
aux normes de la <strong>Revue arch√©ologique de Narbonnaise (RAN)</strong>.<br><br>

<strong>R√®gle appliqu√©e :</strong>
<ul>
<li>suppression de <em>p.</em> ou <em>pp.</em> devant les intervalles de pages
des articles et actes (<code>41-59</code>)</li>
<li>conservation des mentions finales indiquant un nombre total de pages
(<code>536 p.</code>)</li>
</ul>

La mise en forme (gras, italiques) est conserv√©e.
</div>

<h1>Convertisseur normes RAN</h1>

<p>
Collez ci-dessous des r√©f√©rences bibliographiques d√©j√† conformes
aux usages <strong>Mosa√Øques arch√©ologie</strong> afin de les adapter
au format <strong>RAN</strong>.
</p>

<div id="editor" class="editor" contenteditable="true"
placeholder="Collez vos r√©f√©rences ici‚Ä¶"></div>

<div class="notice">
üí° Seuls les <strong>intervalles de pages</strong> sont modifi√©s.  
Les autres mentions de pagination ne sont pas affect√©es.
</div>

<div class="controls">
<button class="btn-main" onclick="convertir()">‚ö° Convertir</button>
<button class="btn-copy" onclick="copier()"> Copier pour Word</button>
<button class="btn-reset" onclick="location.reload()"> R√©initialiser</button>
</div>

<div class="footer">
<a class="tag" href="https://www.asm.cnrs.fr/images/Site/Editions/RAN/RAN-auteurs.pdf" target="_blank">
üìÑ Guide des normes RAN
</a>
<a class="tag" href="https://www.zotero.org/styles/revue-archeologique-de-narbonnaise" target="_blank">
üì¶ Style Zotero CSL RAN
</a>
</div>

</div>

<script>
function convertir() {
    const editor = document.getElementById("editor");
    let html = editor.innerHTML;

    /* Normalisation espaces Word */
    html = html.replace(/&nbsp;|\u00A0|\u202F/g, " ");

    /* Normalisation tirets */
    html = html.replace(/[‚Äì‚Äî]/g, "-");

    /* Suppression p. / pp. devant intervalles */
    html = html.replace(
        /\bpp?\.\s*(\d+\s*-\s*\d+)/gi,
        "$1"
    );

    editor.innerHTML = html;

    editor.style.borderColor = "#27ae60";
    setTimeout(() => editor.style.borderColor = "#e1e5e8", 900);
}

function copier() {
    const editor = document.getElementById("editor");
    const range = document.createRange();
    range.selectNodeContents(editor);
    const sel = window.getSelection();
    sel.removeAllRanges();
    sel.addRange(range);
    document.execCommand("copy");
    sel.removeAllRanges();
    alert("R√©f√©rences copi√©es avec mise en forme.");
}
</script>

</body>
</html>
